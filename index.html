<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>BUKHARIYA EDUCATIONAL CENTRE ‚Äì Student Report</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
    font-family: "Segoe UI", Arial, sans-serif;
    background:#eef2f7;
    margin:0;
    padding:20px;
}
.container{max-width:1000px;margin:auto}
.card{
    background:#fff;
    border-radius:18px;
    box-shadow:0 10px 30px rgba(0,0,0,.1);
    padding:30px;
}
.title{
    text-align:center;
    font-size:32px;
    font-weight:900;
    color:#1e40af;
}
.subtitle{
    text-align:center;
    font-size:18px;
    color:#047857;
    font-weight:700;
    margin-top:6px;
}
.date-row{
    text-align:center;
    margin-top:10px;
    font-size:14px;
    color:#444;
}

.search-only{
    display:flex;
    justify-content:center;
    margin:30px 0;
}
.search-box{
    display:flex;
    gap:10px;
    width:420px;
}
.search-box input{
    flex:1;
    padding:14px;
    font-size:16px;
    border-radius:10px;
    border:1px solid #ccc;
}
.search-box button{
    padding:14px 26px;
    font-size:16px;
    border:none;
    border-radius:10px;
    background:#2563eb;
    color:#fff;
    cursor:pointer;
}
.search-box button:hover{background:#1e40af}

.actions{
    display:flex;
    justify-content:flex-end;
    gap:10px;
    margin-bottom:15px;
}
.actions button{
    padding:10px 18px;
    border:none;
    border-radius:8px;
    font-size:14px;
    cursor:pointer;
}
.print{background:#16a34a;color:#fff}
.pdf{background:#dc2626;color:#fff}

.grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(230px,1fr));
    gap:14px;
}
.box{
    padding:16px;
    border-radius:14px;
    color:#fff;
}
.blue{background:#2563eb}
.green{background:#16a34a}
.orange{background:#f59e0b}
.red{background:#dc2626}
.purple{background:#7c3aed}
.gray{background:#6b7280}

.label{font-size:13px;opacity:.9}
.value{font-size:18px;font-weight:700;margin-top:6px}

.signature-row{
    display:flex;
    gap:30px;
    margin-top:45px;
}
.sign-box{
    flex:1;
    border:2px dashed #999;
    border-radius:14px;
    padding:22px;
    min-height:120px;
}
.sign-title{font-weight:800;margin-bottom:6px}
.sign-sub{font-size:13px;color:#555}

.footer{
    margin-top:35px;
    font-size:13px;
    color:#333;
    line-height:1.7;
}
.footer b{color:#000}

#error{
    text-align:center;
    font-weight:700;
    color:#dc2626;
    margin-bottom:15px;
}

#reportSection{display:none}

@media print{
    body{background:#fff}
    .search-only,.actions{display:none}
}
</style>
</head>

<body>
<div class="container">
<div class="card">

<div class="title">BUKHARIYA EDUCATIONAL CENTRE</div>
<div class="subtitle">Student Performance, Attendance & Discipline Tracker</div>
<div class="date-row">
Date: <span id="engDate"></span> |
Hijri: <span id="hijriDate"></span>
</div>

<!-- SEARCH ONLY VIEW -->
<div class="search-only">
    <div class="search-box">
        <input id="admission" placeholder="Enter Registration / Admission ID">
        <button onclick="searchStudent()">Search</button>
    </div>
</div>

<div id="error"></div>

<!-- FULL REPORT -->
<div id="reportSection">

<div class="actions">
    <button class="print" onclick="window.print()">üñ®Ô∏è Print</button>
    <button class="pdf" onclick="downloadPDF()">üìÑÔ∏è Download PDF</button>
</div>

<div id="result"></div>

<div class="signature-row">
    <div class="sign-box">
        <div class="sign-title">Parent / Guardian</div>
        <div class="sign-sub">Name & Signature</div>
    </div>
    <div class="sign-box">
        <div class="sign-title">Principal</div>
        <div class="sign-sub">Signature & Seal</div>
    </div>
</div>

<div class="footer">
<b>This is a computer generated report.</b><br>
Parents are requested to verify this report carefully and communicate with teachers
to seek necessary guidance for the student‚Äôs progress.
<br><br>
<b>‡¥á‡¥§‡µç ‡¥í‡¥∞‡µÅ ‡¥ï‡¥Æ‡µç‡¥™‡µç‡¥Ø‡µÇ‡¥ü‡µç‡¥ü‡µº ‡¥ú‡¥®‡¥±‡µá‡¥±‡µç‡¥±‡¥°‡µç ‡¥±‡¥ø‡¥™‡µç‡¥™‡µã‡µº‡¥ü‡µç‡¥ü‡¥æ‡¥£‡µç.</b><br>
‡¥∞‡¥ï‡µç‡¥∑‡¥ø‡¥§‡¥æ‡¥ï‡µç‡¥ï‡µæ ‡¥à ‡¥±‡¥ø‡¥™‡µç‡¥™‡µã‡µº‡¥ü‡µç‡¥ü‡µç ‡¥ï‡µÉ‡¥§‡µç‡¥Ø‡¥Æ‡¥æ‡¥Ø‡¥ø ‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï‡¥Ø‡µÅ‡¥Ç,
‡¥Ö‡¥ß‡µç‡¥Ø‡¥æ‡¥™‡¥ï‡¥∞‡µÅ‡¥Æ‡¥æ‡¥Ø‡¥ø ‡¥Ü‡¥∂‡¥Ø‡¥µ‡¥ø‡¥®‡¥ø‡¥Æ‡¥Ø‡¥Ç ‡¥®‡¥ü‡¥§‡µç‡¥§‡¥ø ‡¥µ‡¥ø‡¥¶‡µç‡¥Ø‡¥æ‡µº‡¥§‡µç‡¥•‡¥ø‡¥ï‡¥≥‡µÅ‡¥ü‡µÜ ‡¥™‡µÅ‡¥∞‡µã‡¥ó‡¥§‡¥ø‡¥ï‡µç‡¥ï‡µç
‡¥Ü‡¥µ‡¥∂‡µç‡¥Ø‡¥Æ‡¥æ‡¥Ø ‡¥®‡¥ø‡µº‡¥¶‡µç‡¥¶‡µá‡¥∂‡¥ô‡µç‡¥ô‡µæ ‡¥ö‡µã‡¥¶‡¥ø‡¥ö‡µç‡¥ö‡¥±‡¥ø‡¥Ø‡µÅ‡¥ï‡¥Ø‡µÅ‡¥Ç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡¥£‡¥Ç.
</div>

</div>
</div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<script>
const TSV_URL =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vRS0rtQ6QZb88rLYbBZftXtXieRPLNl7EEu_Eybr-30dmrhvedcNVAIEBFbzcm9DvXo4QZytZGzRzLX/pub?gid=346857694&single=true&output=tsv";

let rows=[];

fetch(TSV_URL)
.then(r=>r.text())
.then(t=>rows=t.trim().split("\n").map(r=>r.split("\t")));

function searchStudent(){
    const id=document.getElementById("admission").value.trim();
    const error=document.getElementById("error");
    const report=document.getElementById("reportSection");
    const result=document.getElementById("result");

    error.textContent="";
    result.innerHTML="";
    report.style.display="none";

    const row=rows.find(r=>r[0]===id);
    if(!row){
        error.textContent="Registration / Admission ID not found";
        return;
    }

    report.style.display="block";

    result.innerHTML=`
    <div class="grid">
        <div class="box blue"><div class="label">Student Name</div><div class="value">${row[1]}</div></div>
        <div class="box gray"><div class="label">Class Ustad</div><div class="value">${row[2]}</div></div>
        <div class="box purple"><div class="label">Month</div><div class="value">${row[3]}</div></div>
        <div class="box orange"><div class="label">Total Leaves</div><div class="value">${row[4]}</div></div>
        <div class="box green"><div class="label">Remaining Leaves</div><div class="value">${row[5]}</div></div>
        <div class="box blue"><div class="label">Lessons Memorized</div><div class="value">${row[6]}</div></div>
        <div class="box green"><div class="label">Pages Studied</div><div class="value">${row[7]}</div></div>
        <div class="box orange"><div class="label">Revisions Completed</div><div class="value">${row[8]}</div></div>
        <div class="box green"><div class="label">Behaviour</div><div class="value">${row[9]}</div></div>
        <div class="box blue"><div class="label">Discipline</div><div class="value">${row[10]}</div></div>
        <div class="box purple"><div class="label">Activities</div><div class="value">${row[11]}</div></div>
        <div class="box gray"><div class="label">Remarks</div><div class="value">${row[12]}</div></div>
        <div class="box blue"><div class="label">Parent Contact</div><div class="value">${row[13]}</div></div>
        <div class="box green"><div class="label">Feedback</div><div class="value">${row[14]}</div></div>
    </div>`;
}

function downloadPDF(){
    html2pdf().set({
        margin:8,
        filename:'Student_Report.pdf',
        image:{type:'jpeg',quality:0.98},
        html2canvas:{scale:2},
        jsPDF:{unit:'mm',format:'a4',orientation:'portrait'}
    }).from(document.querySelector(".card")).save();
}

// Dates
document.getElementById("engDate").textContent =
new Date().toLocaleDateString("en-GB",{day:"2-digit",month:"long",year:"numeric"});

document.getElementById("hijriDate").textContent =
new Intl.DateTimeFormat("en-TN-u-ca-islamic",{day:"numeric",month:"long",year:"numeric"}).format(new Date());
</script>

</body>
</html>
